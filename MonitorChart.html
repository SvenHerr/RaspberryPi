<!DOCTYPE HTML>
<html>

<head>
    <script>
        window.onload = function() {

            var myJson = "";
            var myJsonTest = [];
            var totalCount = 0;
            var count = 0;
            const userAction = async() => {
                const response = await fetch('https://api.herrmannsven.de/pimonitor/getall/?token=123');
                myJson = await response.json(); //extract JSON from the http response
                // do something with myJson

                myJson.forEach(element => {

                    if(element.createDate.includes("2021-12-15T")){
                        if (element.cpuTemperature != 0 & element.cpuTemperature != 123) {
                                myJsonTest.push({
                                    x: count,
                                    y: element.cpuTemperature
                                });

                                count +=1;
                        }
                    }
                    
                    totalCount += 1;
                });

                console.log("found: " + myJsonTest.length + " data. From: " + totalCount);

                doChartStuff();
            };

            function doChartStuff() {
                var chart = new CanvasJS.Chart("chartContainer", {
                    animationEnabled: true,
                    theme: "light2",
                    title: {
                        text: "Magic Mirror Temeratur"
                    },
                    data: [{
                        type: "line",
                        indexLabelFontSize: 16,
                        dataPoints: myJsonTest
                    }]

                });

                chart.render();
            }
            userAction()

        }
    </script>
</head>

<body>
    <div id="chartContainer" style="height: 300px; width: 100%;"></div>
    <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
</body>

</html>